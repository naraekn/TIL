200705_TIL
===

오늘은 이번주에 '새로 배우게 된 것'을 정리한다.

### 사전 강의를 통해 배운 점

1. **http 요청 결과 받아오기 (api)**

    ```fetch```함수를 통해 url의 응답을 반환 받을 수 있다. 이 때, fetch가 반환하는 것은 Promise이기 때문에, fetch를 사용하는 함수는 ```async``` 키워드를 통해 비동기 함수로 만들고, ```fetch``` 앞에는 ```await```를 붙여서 결과를 기다리도록 한다.

    fetch를 통해 받아온 응답을 json형태로 바꾸기 위하여 ```.json()```을 사용한다.

    ```javascript
    export async function fetchCategories() {
      const url = 'https://eatgo-customer-api.ahastudio.com/categories';

      const response = await fetch(url);
      const data = await response.json();
      return data;
    }
    ```

2. **비동기 액션**

    원래 action은 type과 payload를 가진 object를 반환하는 함수였다. 그런데, async 함수를 반환하는 함수도 될 수 있으며, 이 async 함수는 dispatch를 parameter로 받아와서 다른 액션을 실행할 수도 있다. (정확한 동작원리는 모르겠음.)

    ```javascript
    export function loadRegions() {
      return async (dispatch) => {
        const regions = await fetchRegions();

        dispatch(setRegions(regions));
      };
    }
    ```

3. **useEffect**

    App 컴포넌트에서 초기에 세팅을 해줄 때, ```useEffect```를 사용할 수도 있다.

    ```javascript
    useEffect(() => {
        dispatch(loadRegions());
        dispatch(loadCategories());
      }, []);
    ```

4. **redux thunk**

    위에 예시에서 쓴 것과 같이, ```loadRegions```를 액션 중에 하나로 쓰기 위해서는 redux의 ```thunk```라는 것이 필요하다. thunk란, 리덕스의 미들웨어로 action 대신 action 함수를 반환할 수 있도록 해준다. thunk는 store를 만들 때, ```applyMiddleware(thunk)```라는 코드로 등록해준다.

    ```javascript
    import { createStore, applyMiddleware } from 'redux';
    import thunk from 'redux-thunk';

    import reducer from './reducer';

    const store = createStore(reducer, applyMiddleware(thunk));

    export default store;
    ```

