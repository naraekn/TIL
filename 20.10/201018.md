201018_TIL
===

주간 회고
---

1. 성능 최적화 강의들을 들었습니다.

    웹 성능 최적화와 관련된 강의를 들었습니다. 적어도 일주일 중 하루 쯤은 하기로 정해진 공부들이 아니라 내가 궁금한 것을 공부해보고 싶었습니다. 웹의 성능을 측정하고 개선하는 방법들이 평소에 궁금해서, 저번주에는 브라우저가 어떻게 렌더링 되는지에 대해서 훑어봤고, 오늘은 구글 개발자 도구를 통해 performance, lighthouse 기능을 사용하는 방법과 code splitting, bottleneck code 수정, 이미지의 lazy loading 등을 하는 방법들에 대한 강의를 봤습니다. 물론, 아직 100% 이해하지는 못했습니다. 하지만, 내가 궁금한 것들을 자유롭게 찾아보면서 질문을 던지면서 공부할 수 있는 시간을 가질 수 있어서 좋았습니다.

2. 알고리즘 문제풀이를 매일 했고, 왜 문제를 풀어야하는지에 대하여 생각해봤습니다.

    이번주부터는 매일 알고리즘 문제풀이를 하고 인증하는 것을 스터디 팀원과 함께 시작했습니다. 평소 같았으면 매일 하겠다고 마음만 먹고 넘어갔을텐데, 서로 자극을 주고 성장할 수 있는 사람과 함께 하니까 혼자서는 달성하지 못했을 꾸준함을 이뤄낼 수 있었습니다. 하지만, 7일간의 꾸준함을 지키는 것이 저에게 쉬운일은 아니었습니다. 아직 알고리즘 문제풀이가 익숙하지 않아 못푸는 문제가 많다는 점도 있었지만, 문제풀이를 해야하는 목적이 그저 코딩테스트라는 자격을 맞추기 위해서라는 점이 저에게 큰 동기부여가 되지 않았기 때문이었습니다.
    그래서 고민해봤습니다. 왜 좋은 개발자가 되기 위하여 알고리즘 문제풀이를 해야할까요?

    오늘 성능 최적화 강의를 들으며 재미있는 예시를 하나 볼 수 있었습니다. 서버쪽에서 받아온 마크다운 파일에서 마크다운 관련 문법들(#, =, * 등)을 제거하는 함수가 있었는데, `for`와 `while`을 중첩해서 string을 하나하나 비교해서 제거하는 방식이었습니다. 이 때, 강의를 해주시는 분이 성능을 향상시키기 위해, `substring`을 활용하여 비교와 관련된 불필요한 작업들을 줄이고 `replace`와 정규표현식을 써서 더 깔끔한 코드로 불필요한 중첩을 줄이며 성능을 향상시키는 것을 보여주셨습니다. 이렇게 간단한 함수 하나를 고치는 것만으로도 LightHouse에서 성능 점수가 몇십 점이나 오르는 것을 볼 수 있었습니다. 이 강의를 보고 이제까지는 생각해보지 못했던 코드 한줄의 영향력에 대해서 생각해보게 되었습니다. 제가 무심코 적었던 코드 몇줄이 웹사이트에 꽤 큰 영향을 줄 수 있다는 생각이 들었고, 내가 작성하는 코드를 충분히 이해하고 좋은 코드를 만들기 위해 노력하는 것이 중요하겠다는 생각이 들었습니다.

    여러가지 고민 끝에 저는 제 안에서 작은 결론을 하나 내리게 되었습니다. 제가 알고리즘 문제풀이를 해야하는 이유는 물론 코딩테스트를 통과하기 위함도 있을 것입니다. 하지만 그 것보다 조금 더 중요한 것은, 마치 운동선수가 기초체력을 기르듯 개발자도 개발을 하기 위한 기초 체력들을 기르기 위하여 꾸준히 알고리즘 문제풀이를 하는 것이었습니다. 개발자는 문제를 이해하고 이를 코드로서 해결하는 사람이고 알고리즘 문제풀이는 개발자가 밟아야 할 거대한 개발 중 핵심을 연습할 수 있는 아주 작은 단위로 이루어져있기 때문입니다. 감사하게도, 회사가 정해져서 코딩테스트를 당장 봐야할 상황은 당분간 없을거같습니다. 문제의 답을 맞추는데 급급하기 보다, 좋은 코드를 작성하여 문제를 해결하는 것을 연습한다는 조금은 더 본질적인 목표에 집중해서 앞으로 문제를 풀어야겠습니다.

3. 운영체제 스터디, 모던자바스크립트 스터디를 했습니다.

    이번주에도 저번주와 마찬가지로 운영체제 스터디와 모던자바스크립트 스터디를 했습니다. 개념을 정확하게 설명하지 못하는 내 자신의 모습 제대로 외우지 못하는 내 자신의 모습을 마주해야 했습니다. 제가 호기심을 해결하는 선까지 지식을 익히는 것은 좋아하지만, 이 것을 완전히 내 것으로 만들어서 설명할 정도가 될정도까지 지식을 익히는 것은 힘들어 한다는 것을 깨달았습니다. 하지만 반드시 해결해야하는 문제라는 생각이 들었습니다. 설명할 수 없는 지식은 제 지식이라고 할 수 없으니까요. 이 문제를 해결하기 위해서 다음주부터는 새로운 시도(?)를 해보려고 합니다. 그리고 이 시도가 효과적인지는 한 번 다음주 주말에 돌아봐야겠습니다. 


웹 성능 최적화 내용 정리- lecture1
---

* 로딩성능 - 리소스 불러오는 성능 - 어떻게 빠르게 로드할까?
* 렌더링 성능 - 불러온 리소스 화면에 보여주는 성능 - 어떻게 빠르게 렌더링할까?
* 이 두가지 알기 위해서는 어떻게 서버와 통신하는지, 어떻게 브라우저가 렌더링하는지를 이해해야 함

1) 크롬 LightHouse, Performance 기능 사용하기

  * Opportunities = 리소스의 관점에서 가이드 제시함 - 로딩성능
  * Diagnostics = 렌더링 성능 최적화와 관련
  * Passed Audits = 우리가 잘 적용하고 있는 거

2) 이미지 사이즈 줄이기

  * 화면에 렌더링 된 사이즈와 실제 이미지 사이즈를 비교하자하자! ex) 렌더링: 120*120 px - 실제: 1200*1200px => 240*240px이 더 적절함.
  * 실제 사이즈는 렌더링 사이즈의 두배정도가 적당하다. (요즘레티나 디스플레이는 같은 공간에 더 많은 픽셀 그려주므로)
  * api를 통해 이미지를 받아오는 경우, 이미지 사이즈를 줄이는 것은 CDN (Contents Delivery Network: 물리적 거리의 한계를 극복하기 위해 소비자(사용자)와 가까운 곳에 컨텐츠 서버를 두는 기술)을 사용하면 좋다.

3) bottleneck 코드 수정하기

  * 특수문자 효율적으로 제거하는 방법 - nested loop를 통해 하나하나 다 검사하는 로직을 `replace` 함수를 쓰면 루프를 돌 필요가 없음. 또한 특수문자들을 일일히 대응시켜서 비교하는 것이 아니라 정규식을 이용해서 한꺼번에 처리하면 더 빠르게 처리할 수 있음. (마크다운의 특수문자 제거해주는 라이브러리 사용할수도 있음.)
  * 작업하는 양 줄이기 - 모든 문자들을 다 체크하면 느려진다 - 눈 앞에서 보이는 200자만 분석하면 됨. `substring` 사용해서 실제로 화면에 보여지는 페이지만 분석하자.


4) bundle analyzer 사용하기

  * 특정 javascript 파일 다운로드 하는데 시간이 오래걸리면, js 이후부터 코드가 실행되기 때문에 다운로드 걸리는 시간만큼 오래걸림. - 어떻게 이 시간을 줄일까? 
  * webpack bundle analyzer > cra에서는 이젝트하거나 뭐 다운받아야하니까 cra-bundle-analyzer
  * 오래 걸리는 이유 - 홈화면에서는 필요없는 하이라이트 기능 라이브러리도 불러옴 (refractor)
  * code splitting - 불필요한 리소스를 줄이자! 
      * 덩치가 큰 번들파일 작은 사이즈로 만드는 것을 말함.
      * bundle.js 당장 필요하지 않은 뷰페이지까지 로드함.
      * 페이지별로 할 수도 있고, 모듈별로 페이지를 자를 수도 있음. 
      * 불필요한 코드 또는 중복되는 코드가 없이 적절한 사이즈의 코드가 적절한 타이밍에 로드 될 수 있도록 하는 것
      * Route-based code splitting - https://reactjs.org/docs/code-splitting.html
      * 코드 스플리팅을 하는 주체는 webpack이다. - 웹팩 설정하기

5) 텍스트 압축 적용하기

  * 성능 최적화는 프로덕션 빌드에서 체크를 해봐야 함. 
  * 웹에서는 GZIP, Deflate 압축 알고리즘 사용함.
  * 서버쪽에서 처리해 줘야 함.
  * 대규모서비스 - 서버 여러개 띄움. 각각 테스트 압축 코드를 적용하기는 번거로우니 라우터 서버에 텍스트 압축 기능 넣는 경우가 많음.
  * 서버쪽에서 압축해서 보내줌 - 클라이언트 쪽에서 압축 풀어줘야 함. 따라서, 경우에 따라서는 압축을 하고 다시 푸는게 오히려 오버헤드가 클때가 있다. 파일의 크기가 2KB 이상인 경우에는 인코딩을 하는게 좋고, 아닐 때는 그냥 보내는 게 나을 수도 있다.
